"use strict";!function(a,b){var c=a.angular;if(c!==b){var d=c.module("parse-angular",[]);d.run(["$q","$window",function(a,b){if(!c.isUndefined(b.Parse)&&c.isObject(b.Parse)){var d=b.Parse,e={Object:{prototype:["save","fetch","destroy"],"static":["saveAll","destroyAll"]},Query:{prototype:["find","first","count","get"],"static":[]},Cloud:{prototype:[],"static":["run"]},User:{prototype:["signUp"],"static":["requestPasswordReset","logIn"]},FacebookUtils:{prototype:[],"static":["logIn","link","unlink"]},Config:{prototype:[],"static":["get"]}};for(var f in e){var g=f,h=e[f],i=h.prototype,j=h["static"];i.forEach(function(b){var c=d[g].prototype[b];d[g].prototype[b]=function(){return c.apply(this,arguments).then(function(b){var c=a.defer();return c.resolve(b),c.promise},function(b){var c=a.defer();return c.reject(b),c.promise})}}),j.forEach(function(b){var c=d[g][b];d[g][b]=function(){return c.apply(this,arguments).then(function(b){var c=a.defer();return c.resolve(b),c.promise},function(b){var c=a.defer();return c.reject(b),c.promise})}})}}}]),c.module("parse-angular.enhance",["parse-angular"]).run(["$q","$window",function(a,b){function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}if(!c.isUndefined(b.Parse)&&c.isObject(b.Parse)){var e=b.Parse;e.Object.getClass=function(a){return e.Object._classMap[a]};var f=e.Object.extend;e.Object.extend=function(a){var b=f.apply(this,arguments);if(e._.isObject(a)&&e._.isArray(a.attrs)){var c=a.attrs;e._.each(c,function(a){var c=d(a);b.prototype["get"+c]||(b.prototype["get"+c]=function(){return this.get(a)}),b.prototype["set"+c]||(b.prototype["set"+c]=function(b){return this.set(a,b),this})})}return b}}}])}}(this),angular.module("tutrApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","parse-angular","parse-angular.enhance","FacebookPatch","ui.bootstrap","angular-cache","ui-rangeSlider","ngProgress","angular-growl","ngTagsInput","irontec.simpleChat","angularMoment"]).config(["$routeProvider","CacheFactoryProvider","growlProvider",function(a,b,c){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/tutors/",{templateUrl:"views/tutors.html",controller:"TutorsCtrl",controllerAs:"tutors"}).when("/tutors/:subject",{templateUrl:"views/tutors.html",controller:"TutorsCtrl",controllerAs:"tutors"}).when("/tutor/:tutorId",{templateUrl:"views/tutor.html",controller:"TutorCtrl",controllerAs:"tutor"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterCtrl",controllerAs:"register"}).when("/messages",{templateUrl:"views/messages.html",controller:"MessagesCtrl",controllerAs:"messages"}).when("/messages/:dialogId",{templateUrl:"views/dialog.html",controller:"DialogCtrl",controllerAs:"dialog"}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl",controllerAs:"profile"}).otherwise({redirectTo:"/"}),angular.extend(b.defaults,{maxAge:864e5}),c.globalTimeToLive({success:3e3,error:3e3,warning:3e3,info:4e3}),c.globalDisableCountDown(!0)}]).run(["$rootScope","messageService","UserService",function(a,b,c){Parse.initialize("moFYNNMeQQJGz74zgDsbaaLtQfNM4hPgMLdYz54M","0I3OWlWDuZV5udNdosU6xWNBnbJamgyOPApQDK77"),Parse.serverURL="http://ec2-52-31-116-57.eu-west-1.compute.amazonaws.com:1337/parse",a.currentUser=Parse.User.current(),window.fbPromise.then(function(){Parse.FacebookUtils.init({appId:849475151774251,cookie:!0,xfbml:!0,frictionlessRequests:!0})}),a.userType={Student:"Student",Tutor:"Tutor"},b.createQblox(),a.loginToChat=function(){b.loginToChat(a.currentUser).then(function(c){a.$broadcast("userSet",c),a.blockUser=c,a.messageDialogs=b.dialogs}),c.getRoleByUser(a.currentUser).then(function(b){a.currentUserType=b.attributes.name})},a.currentUser&&a.loginToChat(),a.logOut=function(){Parse.User.logOut(),a.currentUser=null,b.logoutFromChat()}}]),angular.module("tutrApp").controller("MainCtrl",["$scope","$rootScope","subjectService","$location",function(a,b,c,d){a.goTo=function(){d.path("/tutors/"+a.subjectSelected)},c.getAllSubjects().then(function(b){a.subjects=b}),a.isStudent=function(){b.currentUserType=b.userType.Student},a.isTutor=function(){b.currentUserType=b.userType.Tutor}}]),angular.module("tutrApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("FacebookPatch",[]).factory("FacebookAngularPatch",["$q","$timeout",function(a,b){var c=function(){var c=[].splice.call(arguments,0),d=a.defer(),e=b;return window.fbPromise.then(function(){c.push(function(a){return _.isUndefined(a.error)?void e(function(){d.resolve(a)}):void e(function(){d.reject(a.error)})}),FB.api.apply(FB,c)}),d.promise};window.fbPromise.then(function(){FB.apiAngular=c})}]),angular.module("tutrApp").controller("TutorsCtrl",["$scope","tutorService","subjectService","$routeParams",function(a,b,c,d){a.minPrice=1,a.maxPrice=24,a.refineOptions={},a.refineOptions.time={min:1,max:24},a.showLoginNudge=!1;var e=a.refineOptions;a.tutorClicked=function(){a.showLoginNudge=!0};var f=function(a){if(e.subject){var b=!1,c=a.attributes.subjects;if(c)for(var d=0;d<c.length;d++){var f=c[d];if(f.attributes.name===e.subject){b=!0;break}}return b}return!0},g=function(a){if(e.distance){var b=!1,c=new Parse.GeoPoint({latitude:0,longitude:0});return navigator.geolocation.getCurrentPosition(function(a){c=new Parse.GeoPoint({latitude:a.coords.latitude,longitude:a.coords.longitude})}),a.attributes.location&&c.milesTo(a.attributes.location)<=e.distance&&(b=!0),b}return!0},h=function(a){if(0!==e.time.min&&24!==e.time.max){var b=!1;if(a.attributes.availability){var c=a.attributes.availability.split("-");c.min=parseInt(c[0]),c.max=parseInt(c[1]),c.min>=e.time.min&&c.max<=e.time.max&&(b=!0)}return b}return!0},i=function(a){if(e.rate){var b=!1;return a.attributes.hourlyRate<=e.rate&&(b=!0),b}return!0},j=function(a){var b=!1;return f(a)&&g(a)&&h(a)&&i(a)&&(b=!0),b};a.refine=function(){var c=[];b.getAllTutors().then(function(b){for(var d=0;d<b.length;d++){var e=b[d];j(e)&&c.push(e)}a.tutors=c})},c.getAllSubjects().then(function(b){a.subjects=b}),d.subject?(a.refineOptions.subject=d.subject,a.refine()):b.getAllTutors().then(function(b){a.tutors=b})}]),angular.module("tutrApp").factory("tutorService",["$q","CacheFactory","UserService",function(a,b,c){var d="tutorCache";b.get(d)||b.createCache(d,{maxAge:36e5,deleteOnExpire:"aggressive"});var e=b.get(d),f=[],g=function(){var b=a.defer();return 0===e.info().size?c.getUsersByRole("Tutor").then(function(a){e.put(d,a),b.resolve(a)}):b.resolve(e.get(d)),b.promise},h=function(b){var c=a.defer();if(0===f.length){var d=new Parse.Query(Parse.User);d.include("subjects"),d.near("location",b),d.find().then(function(a){return f=a,c.resolve(a),a})}else c.resolve(f);return c.promise},i=function(a){for(var b=e.get(d),c=0;c<b.length;c++){var f=b[c];if(f.id===a)return f}},j=function(b){var c=a.defer(),f=e.get(d);return f?c.resolve(f[b]):g().then(function(){f=e.get(d),c.resolve(f[b])}),c.promise};return{getAllTutors:g,getTutorsNearBy:h,getTutorById:i,getTutorByPointer:j}}]),angular.module("tutrApp").controller("TutorCtrl",["$scope","$routeParams","tutorService","messageService",function(a,b,c,d){c.getTutorByPointer(b.tutorId).then(function(b){a.tutor=b}),a.connect=function(){console.log("Connecting with"),console.log(a.tutor),d.createNewDialog(a.tutor)}}]),angular.module("tutrApp").controller("LoginCtrl",["$scope","$rootScope","messageService","UserService","$window",function(a,b,c,d,e){var f={success:function(a){b.currentUser=a,b.$apply(),b.loginToChat(),e.location.href="/#/profile"},error:function(b,c){a.errorMessage="Unable to log in: "+c.message}};a.performLogin=function(b){a.successMessage=null,a.errorMessage=null,Parse.User.logIn(b.email,b.password,f)},a.fbLogin=function(){a.successMessage=null,a.errorMessage=null,Parse.FacebookUtils.logIn(null,f)},a.resetPassword=function(b){a.successMessage=null,a.errorMessage=null,Parse.User.requestPasswordReset(b.email,{success:function(){a.successMessage="A password reset link has been sent to your email address"},error:function(b){a.errorMessage="Could not reset password: "+b.message}})}}]),angular.module("tutrApp").controller("RegisterCtrl",["$scope","$rootScope","UserService",function(a,b,c){a.performRegister=function(d){a.successMessage=null,a.errorMessage=null,b.currentUserType||(a.selectedUserType?b.currentUserType=a.selectedUserType:(a.errorMessage="Please select if you're a Student or Tutor",d.userType.$error.required=!0));var e=c.register(d);e.then(function(){a.successMessage="Thank you "+d.firstName+", you have been successfully registered"},function(b){a.errorMessage="Unable to register: "+b.message})}}]),angular.module("tutrApp").factory("subjectService",["$q","CacheFactory",function(a,b){var c="subjectCache";b.get(c)||b.createCache(c,{deleteOnExpire:"aggressive"});var d=b.get(c),e=function(){var b=a.defer();if(0===d.info().size){var e=new Parse.Query("Subjects");e.include("_Users"),e.find().then(function(a){d.put(c,a),b.resolve(a)})}else b.resolve(d.get(c));return b.promise},f=function(b){var c=a.defer();return e().then(function(a){for(var d=0;d<a.length;d++){var e=a[d];if(e.attributes.name===b){c.resolve(e);break}}c.reject(!1)}),c.promise},g=function(b){var c=a.defer();return e().then(function(a){for(var d=0;d<a.length;d++){var e=a[d];if(e.id===b){c.resolve(e);break}}c.reject()}),c.promise},h=function(b){var c=a.defer(),d=new Parse.Object("Subjects");return d.set("name",b),d.save().then(function(a){c.resolve(a)}),c.promise},i=function(b,c){var d=a.defer();return f(b).then(function(a){c.attributes.subjects.push(a),d.resolve(a)},function(){h(b).then(function(a){c.attributes.subjects.push(a),d.resolve(a)})}),d.promise},j=function(b,c){var d=a.defer();b.attributes.subjects=[];for(var e=[],f=0;f<c.length;f++){var g=c[f],h=i(g,b);e.push(h)}return a.all(e).then(function(){d.resolve()}),d.promise};return{getAllSubjects:e,addSubjectToUser:j,getSubjectById:g}}]),angular.module("tutrApp").controller("MessagesCtrl",["$scope","messageService",function(a,b){a.messageDialogs=b.dialogs}]),angular.module("tutrApp").factory("messageService",["$q","$rootScope",function(a,b){function c(a,c){console.log(c);var d={sender_id:a,recipient_id:f,message:c.body,created_at:Date.now()},e=c.dialog_id;g[e]?g[e].items.push(d):(g[e]={items:[]},g[e].items.push(d)),g[e].unread_messages_count?g[e].unread_messages_count++:g[e].unread_messages_count=1,b.$broadcast("newMessage")}var d=[],e={},f=[],g=[],h=[],i=function(){var a={chatProtocol:{active:2},debug:!1};QB.init(26337,"MkgE4ke6EsCGSsu","5emhh3z5nwytLDR",a)},j=function(){QB.users.listUsers({},function(a,b){if(b)for(var c=0;c<b.items.length;c++){var e=b.items[c].user;d.push(e)}})},k=function(a,b,d){f=a.user_id,j(),QB.chat.connect({userId:f,password:b.id},function(a,b){a||(h=b)}),QB.chat.onMessageListener=c,r().then(function(){d.resolve(a)})},l=function(a,b){QB.createSession(function(c,d){if(d){var e={email:a.attributes.username,password:a.id,full_name:a.attributes.firstName};QB.users.create(e,function(c,d){d&&QB.login(e,function(c,d){k(d,a,b)})})}})},m=function(b){var c=a.defer();return QB.createSession({email:b.attributes.username,password:b.id},function(a,d){d?k(d,b,c):l(b,c)}),c.promise},n=function(){QB.chat.disconnect()},o=function(a){for(var b=0;b<d.length;b++){var c=d[b];if(c.email.toLowerCase()===a.toLowerCase())return c}},p=function(b){var c=a.defer(),d={chat_dialog_id:b,sort_asc:"date_sent",limit:100,skip:0};return QB.chat.message.list(d,function(a,d){g[b]=d,c.resolve(g[b])}),c.promise},q=function(a){function b(){for(var b=!1,c=0;c<e.items.length;c++){var d=e.items[c];if(d._id===a){b=d;break}}return b}var c=b();return c?c:void r().then(function(){return b(a)})},r=function(){var b=a.defer(),c=null;return QB.chat.dialog.list(c,function(a,c){a||(angular.copy(c,e),b.resolve(e))}),b.promise},s=function(a){var b=o(a.attributes.username);console.log("User Found:"),console.log(b);var c={type:3,occupants_ids:b.id};QB.chat.dialog.create(c,function(a,b){a?console.log(a):(r(),console.log(b))})},t=function(a,c){var d={type:"chat",body:c,extension:{save_to_history:1},senderId:f},e=QB.chat.helpers.getRecipientId(a.occupants_ids,f);QB.chat.send(e,d);var h={sender_id:f,recipient_id:e,message:d.body,created_at:Date.now()};g[a._id].items.push(h),b.$broadcast("newMessage")};return{createQblox:i,loginToChat:m,logoutFromChat:n,createNewDialog:s,getDialogslist:r,getDialog:q,dialogs:e,sendMessageToUser:t,listOfUsers:d,retrieveChatMessages:p,messages:g,currentLoggedInUserId:f}}]),angular.module("tutrApp").controller("DialogCtrl",["$scope","messageService","$routeParams","$rootScope",function(a,b,c,d){var e=function(){a.dialog=b.getDialog(c.dialogId),a.dialogId=c.dialogId,a.messages=b.messages[c.dialogId],a.currentLoggedInUserId=d.blockUser.user_id,setTimeout(function(){$(".messages").animate({scrollTop:$(".messages")[0].scrollHeight},1e3)},1e3)};b.messages[c.dialogId]?e():d.blockUser?b.retrieveChatMessages(c.dialogId).then(function(){e()}):a.$on("userSet",function(){b.retrieveChatMessages(c.dialogId).then(function(){e()})}),d.$on("newMessage",function(){"$apply"!==a.$root.$$phase&&"$digest"!==a.$root.$$phase&&a.$apply();var b=$(".messages");b[0].scrollHeight-b.scrollTop()<=b.outerHeight()+1e3&&b.animate({scrollTop:$(".messages")[0].scrollHeight},1e3)}),a.sendMessage=function(){var c=a.newMessage;c&&""!==c&&b.sendMessageToUser(a.dialog,c),a.newMessage=""}}]),angular.module("tutrApp").filter("qbloxUserById",["messageService",function(a){return function(b){for(var c=a.listOfUsers,d=0;d<c.length;d++){var e=c[d];if(e.id===b)return e.full_name}}}]),angular.module("tutrApp").factory("UserService",["$rootScope","messageService","$q",function(a,b,c){var d=function(d){var e=c.defer(),g=new Parse.User;return g.setEmail(d.email),g.setUsername(d.email),g.setPassword(d.password),g.set("firstName",d.firstName),g.set("lastName",d.lastName),g.signUp(null,{success:function(c){b.loginToChat(c),a.currentUser=c,a.$apply(),f(c,a.currentUserType),e.resolve(c)},error:function(a){e.reject(a)}}),e.promise},e=function(d){var e=c.defer(),f={success:function(c){a.currentUser=c,a.$apply(),b.loginToChat(c),h(c).then(function(b){a.currentUserType=b.attributes.name}),e.resolve(c)},error:function(a,b){e.reject(b)}};return Parse.User.logIn(d.email,d.password,f),e.promise},f=function(b,d){var e=c.defer();a.currentUserType=d;var f=new Parse.Query(Parse.Role);return f.equalTo("name",a.currentUserType),f.first({success:function(a){console.log(a),a.getUsers().add(b),a.save(),e.resolve(!0)},error:function(a,b){e.reject(!1),console.log(b)}}),e.promise},g=function(a,b){var c=new Parse.Query(Parse.Role);c.find().then(function(c){for(var d=0;d<c.length;d++){var e=c[d];e.getUsers().remove(a),e.save()}f(a,b)})},h=function(a){var b=c.defer(),d=new Parse.Query(Parse.Role);return d.equalTo("users",a),d.first().then(function(a){a?b.resolve(a):b.reject(!1)},function(a){b.reject(a)}),b.promise},i=function(a){var b=c.defer(),d=new Parse.Query(Parse.Role);return d.equalTo("name",a),d.first().then(function(a){var c=a.relation("users").query();c.include("subjects"),c.find().then(function(a){b.resolve(a)},function(a){b.reject(a)})},function(a){b.reject(a)}),b.promise};return{register:d,getUsersByRole:i,addRoleToUser:f,changeUserRole:g,getRoleByUser:h,signIn:e}}]),angular.module("tutrApp").controller("ProfileCtrl",["$scope","$q","$rootScope","UserService","subjectService","growl",function(a,b,c,d,e,f){function g(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16||0;return a=Math.floor(a/16),("x"===b?c:3&c|8).toString(16)});return b}var h,i=c.currentUser,j=angular.copy(c.currentUser),k=i.attributes.subjects||[];a.userSubjects=[],"string"==typeof c.currentUser.attributes.availability&&(c.currentUser.attributes.availability={startTime:"",endTime:""}),a.subjects=[],e.getAllSubjects().then(function(b){for(var c=0;c<b.length;c++){var d=b[c];a.subjects.push(d.attributes.name)}});for(var l=function(b){e.getSubjectById(b).then(function(b){var c={text:b.attributes.name};a.userSubjects.push(c)})},m=0;m<k.length;m++){var n=k[m];l(n.id)}d.getRoleByUser(i).then(function(b){h=b.attributes.name,a.currentUserType=b.attributes.name},function(a){console.log(a)});var o=function(){var d=b.defer();if(a.newImage){var e=a.newImage.file.type.split("/")[1],f=new Parse.File(g()+"."+e,{base64:a.newImage.dataURL});f.save().then(function(a){c.currentUser.attributes.picture=a,d.resolve()})}else d.resolve();return d.promise};a.addLocation=function(){console.log("run");var a=b.defer();if(c.currentUser.attributes.postCode!==j.attributes.postCode){var d="http://maps.googleapis.com/maps/api/geocode/json?address={{postCode}},+UK&sensor=false";$.get(d.replace("{{postCode}}",c.currentUser.attributes.postCode),function(b){if("OK"===b.status){var d=b.results[0].geometry.location;console.log(d),c.currentUser.attributes.location=new Parse.GeoPoint({latitude:d.lat,longitude:d.lng}),a.resolve()}else a.resolve()})}else a.resolve();return a.promise};var p=function(){var e=b.defer();return h!==a.currentUserType?(d.changeUserRole(c.currentUser,a.currentUserType),e.resolve()):e.resolve(),e.promise},q=function(){var d=b.defer();if(k!==a.userSubjects){for(var f=[],g=0;g<a.userSubjects.length;g++){var h=a.userSubjects[g];f.push(h.text)}e.addSubjectToUser(c.currentUser,f).then(function(){d.resolve()})}else d.resolve();return d.promise};a.save=function(){i=c.currentUser;var d=[];d.push(o()),d.push(a.addLocation()),d.push(p()),d.push(q()),b.all(d).then(function(){Parse.User.current().set(c.currentUser).save(null,{success:function(a){console.log(a),f.success("User changes saved successfully!")},error:function(a){f.error(a)}})})},a.cancel=function(){c.currentUser=j,a.newImage=null,f.info("User changes were discarded")}}]),angular.module("tutrApp").directive("image",["$q",function(a){var b=window.URL||window.webkitURL,c=function(){var a="fileupload-resize-area",b=document.getElementById(a);return b||(b=document.createElement("canvas"),b.id=a,b.style.visibility="hidden",document.body.appendChild(b)),b},d=function(a,b){var d=b.resizeMaxHeight||300,e=b.resizeMaxWidth||250,f=b.resizeQuality||.7,g=b.resizeType||"image/jpg",h=c(),i=a.height,j=a.width;j>i?j>e&&(i=Math.round(i*=e/j),j=e):i>d&&(j=Math.round(j*=d/i),i=d),h.width=j,h.height=i;var k=h.getContext("2d");return k.drawImage(a,0,0,j,i),h.toDataURL(g,f)},e=function(a,b){var c=new Image;c.onload=function(){b(c)},c.src=a},f=function(b){var c=a.defer(),d=new FileReader;return d.onload=function(a){c.resolve(a.target.result)},d.readAsDataURL(b),c.promise};return{restrict:"A",scope:{image:"=",resizeMaxHeight:"@?",resizeMaxWidth:"@?",resizeQuality:"@?",resizeType:"@?"},link:function(a,c,g){var h=function(b,c){e(b.url,function(e){var f=d(e,a);b.resized={dataURL:f,type:f.match(/:(.+\/.+);/)[1]},c(b)})},i=function(b){a.$apply(function(){g.multiple?a.image.push(b):a.image=b})},j=function(c){var d={file:c,url:b.createObjectURL(c)};f(c).then(function(a){d.dataURL=a}),a.resizeMaxHeight||a.resizeMaxWidth?h(d,function(a){i(a)}):i(d)};c.bind("change",function(b){g.multiple&&(a.image=[]);for(var c=b.target.files,d=0;d<c.length;d++)j(c[d])})}}}]),angular.module("tutrApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/dialog.html",'<div class="row"> <div class="col-lg-3 col-md-3 chat-th-material no-pad"> <div class="panel no-border"> <div class="panel-heading chat-top-bar darker"> <div class="col-md-8 col-xs-8"> <h3 class="panel-title">Messages</h3> </div> </div> <div class="panel-body msg-container-base round-bottom-left"> <ul class="list-group pad-top"> <li class="list-group-item" ng-repeat="dialog in messageDialogs.items"> <span class="badge" ng-show="dialog.unread_messages_count">{{dialog.unread_messages_count}}</span> <a ng-href="/#/messages/{{dialog._id}}">Chat between {{dialog.occupants_ids[0] | qbloxUserById }} and {{dialog.occupants_ids[1] | qbloxUserById }}</a> </li> </ul> </div> </div> </div> <div class="col-xs-12 col-md-9 col-lg-9 chat-th-material no-pad-left"> <div class="panel no-border"> <div class="panel-heading chat-top-bar"> <div class="col-md-8 col-xs-8"><h3 class="panel-title ng-binding"><span class="fa fa-comment-o"></span> Chat between {{dialog.occupants_ids[0] | qbloxUserById }} and {{dialog.occupants_ids[1] | qbloxUserById }}</h3></div> </div> <div class="panel-body msg-container-base messages"> <div class="row msg-container" ng-repeat="message in messages.items"> <div class="col-md-12 col-xs-12"> <div class="chat-msg" ng-class="{\'chat-msg-sent\': message.sender_id == currentLoggedInUserId, \'chat-msg-recieved\': message.sender_id != currentLoggedInUserId}"> <p>{{message.message}}</p> <div class="chat-msg-author"><strong ng-hide="message.sender_id == currentLoggedInUserId">{{message.sender_id | qbloxUserById}}</strong><strong ng-show="message.sender_id == currentLoggedInUserId">Me</strong>&nbsp;<span class="date" am-time-ago="message.created_at"></span></div> </div> </div> </div> </div> <div class="panel-footer chat-bottom-bar"> <form ng-submit="sendMessage(newMessage)"> <div class="input-group"><input type="text" class="form-control input-sm chat-input" placeholder="You can write here" ng-model="newMessage"><span class="input-group-btn"><input type="submit" class="btn btn-sm chat-submit-button" value="Send your message"></span></div> </form> </div> </div> </div> </div>'),a.put("views/login.html",'<div class="row"> <div ng-show="currentUser" class="col-md-6 col-md-offset-3 pad-bottom jumbotron"> <h1>Hey {{currentUser.attributes.firstName}} </h1> <h3>You\'re already logged in</h3> <hr> <a href="#/profile" class="btn btn-primary">Go to Profile</a> </div> <div ng-hide="currentUser" class="col-md-6 col-md-offset-3 pad-bottom"> <h2>Login</h2> <div ng-show="successMessage" class="alert alert-success">{{successMessage}}</div> <div ng-show="errorMessage" class="alert alert-danger">{{errorMessage}}</div> <form name="loginForm" ng-submit="performLogin(login)" role="form"> <div class="form-group" ng-class="{ \'has-error\': loginForm.email.$dirty && loginForm.email.$error.required }"> <label for="email">Email Address</label> <input type="email" name="email" id="email" class="form-control" ng-model="login.email" autocomplete="on" required> <span ng-show="loginForm.email.$dirty && loginForm.email.$error.required" class="help-block">Email address is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': loginForm.password.$dirty && loginForm.password.$error.required }"> <label for="password">Password</label> <input type="password" name="password" id="password" class="form-control" ng-model="login.password" autocomplete="on" required> <span ng-show="loginForm.password.$dirty && loginForm.password.$error.required" class="help-block">Password is required</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="loginForm.$invalid || loginForm.dataLoading" class="btn btn-primary">Login </button> <a ng-click="fbLogin()" class="btn btn-info">Facebook Login</a> <a ng-click="resetPassword(login)" class="btn btn-default" ng-disabled="loginForm.email.$invalid">Reset Password</a> <img ng-if="loginForm.dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> </div> </form> </div> </div>'),a.put("views/main.html",'<div class="jumbotron fadeOnShow" ng-show="$root.currentUserType == $root.userType.Tutor"> <h1>Let\'s get you some students!</h1> <p><a class="btn btn-lg btn-success" ng-href="#/login">Login</a></p> </div> <div class="jumbotron fadeOnShow" ng-show="$root.currentUserType == $root.userType.Student"> <h1>What do you need help with?</h1> <form ng-submit="goTo()"> <p class="lead"> <input type="text" ng-model="subjectSelected" placeholder="What subject do you need help with" typeahead="subject.attributes.name for subject in subjects | filter:$viewValue" typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control"> <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i> <div ng-show="noResults"> <i class="glyphicon glyphicon-remove"></i> No Results Found </div> </p> <p> <button type="submit" class="btn btn-lg btn-success">Find me a tutor <span class="glyphicon glyphicon-ok"></span></button> </p> </form> </div> <div class="jumbotron"> <h1>We &lt;3 Teaching</h1> <p class="lead"> Are you a... </p> <p><a class="btn btn-lg btn-success marg-right" ng-click="isStudent()">Student</a><a class="btn btn-lg btn-success margin" ng-click="isTutor()">Tutor</a></p> </div> <div class="row marketing"> <div class="col-md-4"> <i class="fa fa-money"></i> <h2>It\'s Free</h2> </div> <div class="col-md-4"> <i class="fa fa-university"></i> <h2>We verify all the tutors</h2> </div> <div class="col-md-4"> <i class="fa fa-mobile"></i> <h2>We have an app</h2> </div> </div>'),a.put("views/messages.html",'<p>This is the messages view.</p> <div ng-repeat="dialog in messageDialogs.items"> <a ng-href="/#/messages/{{dialog._id}}">{{dialog._id}} Chat between {{dialog.occupants_ids[0] | qbloxUserById }} and {{dialog.occupants_ids[1] | qbloxUserById }}</a> </div>'),a.put("views/profile.html",'<div ng-show="currentUser"> <div class="container"> <h1>Edit Profile</h1> <hr> <div class="row"> <!-- left column --> <div class="col-md-3"> <div class="text-center"> <img ng-show="newImage" ng-src="{{newImage.url}}" type="{{newImage.file.type}}" class="avatar img-circle full-width" alt="avatar"> <img ng-show="currentUser.attributes.picture" ng-src="{{currentUser.attributes.picture.url()}}" class="avatar img-circle full-width" alt="avatar"> <img ng-hide="currentUser.attributes.picture || newImage" src="http://simpleicon.com/wp-content/uploads/user-2.png" class="avatar img-circle full-width" alt="avatar"> <h6>Upload a different photo...</h6> <input type="file" accept="image/*" image="newImage" class="form-control"> </div> </div> <!-- edit form column --> <div class="col-md-9 personal-info"> <!--<div class="alert alert-info alert-dismissable">--> <!--<a class="panel-close close" data-dismiss="alert">×</a>--> <!--<i class="fa fa-coffee"></i>--> <!--This is an <strong>.alert</strong>. Use this to show important messages to the user.--> <!--</div>--> <form class="form-horizontal" role="form"> <div class="form-group"> <label class="col-lg-3 control-label">First name:</label> <div class="col-lg-8"> <input class="form-control" type="text" ng-model="currentUser.attributes.firstName"> </div> </div> <div class="form-group"> <label class="col-lg-3 control-label">Last name:</label> <div class="col-lg-8"> <input class="form-control" type="text" ng-model="currentUser.attributes.lastName"> </div> </div> <div class="form-group"> <label class="col-lg-3 control-label">About Me:</label> <div class="col-lg-8"> <textarea class="form-control" type="text" ng-model="currentUser.attributes.aboutMe"></textarea> </div> </div> <div class="form-group"> <label class="col-lg-3 control-label">Email:</label> <div class="col-lg-8"> <input class="form-control" type="text" ng-model="currentUser.attributes.username"> </div> </div> <div class="form-group"> <label class="col-lg-3 control-label">Availability:</label> <div class="col-lg-8"> <div class="col-lg-4 no-pad"> <input class="form-control" type="text" ng-model="currentUser.attributes.availability.startTime" placeholder="Start time e.g. 9"> </div> <div class="col-lg-4"> <input class="form-control" type="text" ng-model="currentUser.attributes.availability.endTime" placeholder="End time e.g. 17"> </div> </div> </div> <div class="form-group"> <label class="col-md-3 control-label">Your Location:</label> <div class="col-md-6"> <input class="form-control" placeholder="Postcode" type="text" ng-model="currentUser.attributes.postCode"> </div> <div class="col-md-2"> <button class="btn btn-primary" ng-click="addLocation()">Assign</button> </div> {{currentUser.attributes.location | json}} </div> <div class="form-group"> <label class="col-md-3 control-label" ng-show="currentUserType == \'Tutor\'">Your Rate(per hour):</label> <label class="col-md-3 control-label" ng-hide="currentUserType == \'Tutor\'">Your Budget(per hour):</label> <div class="col-md-1 pad width-2">£</div> <div class="col-md-8 rate-col"> <input class="form-control" type="text" ng-model="currentUser.attributes.hourRate" placeholder="20"> </div> </div> <div class="form-group" ng-show="currentUserType == \'Tutor\'"> <label class="col-md-3 control-label">Subjects you teach:</label> <div class="col-md-8"> <tags-input placeholder="Subject" ng-model="userSubjects"> <auto-complete source="subjects"></auto-complete> </tags-input> </div> </div> <div class="form-group" ng-show="currentUserType == \'Tutor\'"> <label class="col-md-3 control-label">Your highest level of education:</label> <div class="col-md-8"> <div class="col-lg-5 no-pad p"> <input class="form-control" type="text" ng-model="currentUser.attributes.Degree" placeholder="Degree"> </div> <div class="col-lg-1 pad">at</div> <div class="col-lg-6"> <input class="form-control" type="text" ng-model="currentUser.attributes.nameOfUniversity" placeholder="Name of University"> </div> </div> </div> <div class="form-group"> <label class="col-md-3 control-label">Your\'re a:</label> <div class="col-md-8 rate-col marg-left pad"> <select name="userType" id="" ng-model="currentUserType"> <option value="Student">Student</option> <option value="Tutor">Tutor</option> </select> </div> </div> <div class="form-group"> <label class="col-md-3 control-label"></label> <div class="col-md-8"> <input type="submit" class="btn btn-primary" ng-click="save()" value="Save Changes"> <span></span> <input type="button" class="btn btn-default" ng-click="cancel()" value="Cancel"> </div> </div> </form> </div> </div> </div> <hr> </div> <div ng-hide="currentUser"></div>'),a.put("views/register.html",'<div class="col-md-6 col-md-offset-3"> <h2>Register</h2> <div ng-show="successMessage" class="alert alert-success">{{successMessage}}</div> <div ng-show="errorMessage" class="alert alert-danger">{{errorMessage}}</div> <form name="form" ng-submit="performRegister(register)" role="form"> <div class="form-group" ng-class="{ \'has-error\': registerForm.firstName.$dirty && registerForm.firstName.$error.required }"> <label for="firstName">First Name</label> <input type="text" name="firstName" id="firstName" class="form-control" ng-model="register.firstName" required> <span ng-show="registerForm.firstName.$dirty && registerForm.firstName.$error.required" class="help-block">First name is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': registerForm.lastName.$dirty && registerForm.lastName.$error.required }"> <label for="lastName">Last Name</label> <input type="text" name="lastName" id="Text1" class="form-control" ng-model="register.lastName" required> <span ng-show="registerForm.lastName.$dirty && registerForm.lastName.$error.required" class="help-block">Last name is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': registerForm.email.$dirty && registerForm.email.$error.required }"> <label for="email">Email Address</label> <input type="email" name="email" id="email" class="form-control" ng-model="register.email" required> <span ng-show="registerForm.email.$dirty && registerForm.email.$error.required" class="help-block">Email address is required</span> </div> <div class="form-group" ng-class="{ \'has-error\': registerForm.password.$dirty && registerForm.password.$error.required }"> <label for="password">Password</label> <input type="password" name="password" id="password" class="form-control" ng-model="register.password" required> <span ng-show="registerForm.password.$dirty && registerForm.password.$error.required" class="help-block">Password is required</span> </div> <div class="form-group" ng-hide="$root.currentUserType" ng-class="{ \'has-error\': registerForm.selectedUserType.$error.required }"> <label for="userType" class="control-label input-group">You\'re a</label> <div class="btn-group" data-toggle="buttons"> <label class="btn btn-default" ng-model="selectedUserType" btn-radio="userType.Student">Student</label> <label class="btn btn-default" ng-model="selectedUserType" btn-radio="userType.Tutor">Tutor</label> </div> <span ng-show="registerForm.selectedUserType.error" class="help-block">User Type is required</span> </div> <div class="form-actions"> <button type="submit" ng-disabled="registerForm.$invalid || regsterForm.dataLoading" class="btn btn-primary"> Register </button> <a href="#/login" class="btn btn-default">Cancel</a> <img ng-if="regsterForm.dataLoading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="> <a href="#/login" class="btn btn-link">Already registered?</a> </div> </form> </div>'),
a.put("views/tutor.html",'<link href="http://fontawesome.io/assets/font-awesome/css/font-awesome.css" rel="stylesheet" media="screen"> <div class="row user-menu-container square"> <div class="col-md-12 user-details"> <div class="row coralbg white"> <div class="col-md-6 no-pad"> <div class="user-image"> <img src="https://farm7.staticflickr.com/6163/6195546981_200e87ddaf_b.jpg" class="img-responsive thumbnail"> </div> </div> <div class="col-md-6 no-pad"> <div class="user-pad"> <h3>{{tutor.attributes.firstName}} {{tutor.attributes.lastName}}</h3> <h4 class="white"><i class="fa fa-check-circle-o"></i> Facebook verified</h4> <h4 class="white"><i class="fa fa-check-circle-o"></i> CRB verified</h4> <h4 class="white"><i class="fa fa-check-circle-o"></i> Qualifications verified</h4> <button ng-click="connect()" type="button" class="btn btn-labeled btn-info" href="#"> <span class="btn-label"><i class="fa fa-pencil"></i></span>Connect </button> </div> </div> </div> <div class="row overview"> <div class="col-md-10 user-pad text-center"> <h3>Connections</h3> <h4>2,784</h4> </div> <div class="col-md-10 user-pad text-center"> <h3>Rating</h3> <h4>5 stars</h4> </div> <div class="col-md-10 user-pad text-center"> <h3>Reply rate</h3> <h4>89%</h4> </div> </div> </div> </div> <div class="row margin-top-thick"> <div class="col-md-12"> <b>Subjects:</b> <ul class="list-single-line subjects" ng-repeat="subject in tutor.attributes.subjects"> <li class="list-item">{{subject.attributes.name}}</li> </ul> </div> </div> <hr> <div class="row"> <div class="col-md-12"> <b>About me:</b> <p>{{tutor.attributes.aboutMe}}</p> </div> </div>'),a.put("views/tutors.html",'<div class="container" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-3 sidebar jumbotron"> <form class="form-horizontal"> <fieldset> <!-- Form Name --> <legend>Find your perfect tutor</legend> <!-- Text input--> <div class="form-group"> <label class="col-md-12 control-label" for="Subject">Subject</label> <div class="col-md-12"> <input type="text" ng-model="refineOptions.subject" name="Subject" placeholder="Subject" typeahead="subject.attributes.name for subject in subjects | filter:$viewValue" typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control"> <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i> <div ng-show="noResults"> <i class="glyphicon glyphicon-remove"></i> No Results Found </div> </div> </div> <!-- Text input--> <div class="form-group"> <label class="col-md-12 control-label" for="Distance from you">Distance from you</label> <div class="col-md-12"> <input id="Distance from you" ng-model="refineOptions.distance" name="Distance from you" type="text" placeholder="Distance in miles" class="form-control input-md"> </div> </div> <!-- Text input--> <div class="form-group"> <label class="col-md-12 control-label" for="betweenTime">Between Time</label> <div class="col-md-12"> <div range-slider name="betweenTime" min="0" max="24" model-min="refineOptions.time.min" model-max="refineOptions.time.max" step="2"></div> </div> </div> <!-- Text input--> <div class="form-group"> <label class="col-md-12 control-label" for="textinput">Maximum Hourly Rate</label> <div class="col-md-12"> <input id="textinput" name="textinput" type="text" ng-model="refineOptions.rate" placeholder="Hourly Rate (£)" class="form-control input-md"> </div> </div> <!-- Button --> <div class="form-group"> <label class="col-md-10 control-label" for="singlebutton"></label> <div class="col-md-12"> <button id="singlebutton" name="singlebutton" ng-click="refine()" class="btn btn-primary full-width">Find</button> </div> </div> </fieldset> </form> </div> <div class="col-md-8"> <div class="jumbotron fadeOnShow" ng-show="showLoginNudge"> <h2>Register to see the full tutor profile</h2> <h4>it\'s free!</h4> <div class="marg-top"> <a class="btn btn-primary" ng-href="/#/register">Register</a> <a class="btn btn-info" ng-href="/#/login">Login</a> </div> </div> <ul class="list-no-style"> <li ng-repeat="(key,tutor) in tutors"> <div class="row panel"> <div class="col-md-2"> <img ng-show="tutor.attributes.picture" ng-src="{{currentUser.attributes.picture}}" class="img-thumbnail" alt="avatar"> <img ng-hide="tutor.attributes.picture" src="http://simpleicon.com/wp-content/uploads/user-2.png" class="img-thumbnail"> </div> <div class="col-md-9 col-xs-12"> <div class="header"> <h1> <div ng-if="currentUser"> <a ng-href="#/tutor/{{key}}"> {{tutor.attributes.firstName}} </a> </div> <div ng-if="!currentUser"> <a ng-click="tutorClicked()" href=""> {{tutor.attributes.firstName}} </a> </div> </h1> <rating ng-model="tutor.attributes.rating" max="5" readonly on-hover="hoveringOver(value)" on-leave="overStar = null" titles="[\'one\',\'two\',\'three\']"></rating> <h4> <ul class="list-single-line subjects"> <li ng-repeat="subject in tutor.attributes.subjects" class="list-item thick-pad"> {{subject.attributes.name}} </li> </ul> </h4> <span class="clearfix">{{tutor.attributes.aboutMe}}</span> </div> </div> </div> </li> </ul> </div> </div>')}]);